<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <!-- VSS Framework -->
    <script src="../lib/VSS.SDK.min.js"></script>
    <style>
        body {
            background-color: rgb(0, 67, 117);
            color: white;
            margin: 10px;    
            font-family: "Segoe UI VSS (Regular)","-apple-system",BlinkMacSystemFont,"Segoe UI",sans-serif;
        }
    </style>
    <script type="text/javascript">
        VSS.init({
            explicitNotifyLoaded: true,
            usePlatformScripts: true,
            usePlatformStyles: true
        });

        // Use an IIFE to create an object that satisfies the IContributedMenuSource contract
        var menuContributionHandler = (function () {
            "use strict";
            return {
                // This is a callback that gets invoked when a user clicks the newly contributed menu item
                // The actionContext parameter contains context data surrounding the circumstances of this
                // action getting invoked.
                execute: function (actionContext) {
                    VSS.getService(VSS.ServiceIds.Dialog).then(function(dialogService) {
                        var extensionCtx = VSS.getExtensionContext();
                        // Build absolute contribution ID for dialogContent
                        var contributionId = extensionCtx.publisherId + "." + extensionCtx.extensionId + ".create-child-links-work-item-form-page";

                        // Show dialog
                        var dialogOptions = {
                            title: "Create follow-up task in DSD team.",
                            width: 800,
                            height: 600
                        };

                        let dialogReturn = dialogService.openDialog(contributionId, dialogOptions);
                    });
                }
            };
        }());

        // Associate the menuContributionHandler object with the "myAction" menu contribution from the manifest.
        VSS.register("create-child-links-work-item-button", menuContributionHandler);

        VSS.ready(function () {
            VSS.notifyLoadSucceeded();
        });
    </script>
</head>

<body>

</body>

</html>